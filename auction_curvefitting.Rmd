---
title: "C-Band Estimation"
output:
  word_document: default
  html_notebook: default
---
How much could C-Band garner in revenues if it came to market? Let's find out.  

To begin, let's start by loading all of the libraries we will need for this project.
```{r}
library(tidyr)
library(MASS)
library(dplyr)
library(fitdistrplus)
library(rstan)
library(car)
library(readxl)
```
Next, let's take a look at the previous auctions in the C-band range, from 1 GHz up to about 5 GHz to see what the distributions look like.
```{r}
auction_data <- read.csv("Auction_Joins.csv", header=T) %>%
  mutate(Cost_MHz_pop = as.numeric(as.character(Cost_MHz_pop))) %>%
  filter(Cost_MHz_pop > 0)

auction_data41 <- auction_data %>% filter(AUCTION_NUMBER == "41")
auction_data53 <- auction_data %>% filter(AUCTION_NUMBER == "53") 
auction_data58 <- auction_data %>% filter(AUCTION_NUMBER == "58")
auction_data66 <- auction_data %>% filter(AUCTION_NUMBER == "66")
auction_data69 <- auction_data %>% filter(AUCTION_NUMBER == "69") 
auction_data71 <- auction_data %>% filter(AUCTION_NUMBER == "71") 
```
All of the data has been normalized to June 2019 prices using CPI indices. How does this data fit?
```{r}
descdist(auction_data$Cost_MHz_pop, discrete=FALSE, boot=500)
```
```{r}
descdist(auction_data41$Cost_MHz_pop, discrete=FALSE, boot=500)
```
```{r}
descdist(auction_data53$Cost_MHz_pop, discrete=FALSE, boot=500)
```
```{r}
descdist(auction_data58$Cost_MHz_pop, discrete=FALSE, boot=500)
```
```{r}
descdist(auction_data66$Cost_MHz_pop, discrete=FALSE, boot=500)
```
```{r}
descdist(auction_data69$Cost_MHz_pop, discrete=FALSE, boot=500)
```
```{r}
descdist(auction_data71$Cost_MHz_pop, discrete=FALSE, boot=500)
```
So it seems the best distribution here is the Gamma distribution. So let's fit the data we have on the C-Band auctions around the world and fit it to a Gamma distribution. 
```{r}
c_band_auctions <- read_excel("5G_spectrum_database.xlsx", sheet = 2)
fp <- fitdist(c_band_auctions$fee_per_mhz_pop_june2019, "gamma")
summary(fp)

```
In other words, α = 1.040088, β = 5.150726. Since the mean is α/β (1.040088/5.150726), the calculcation comes to 0.201. Next let's compute the 95% confidence interval through the quantile function in R.
```{r}

quantile(fp, probs=c(0.05, 0.95))

```
This gives us a mean of 0.201 with a 95% CI of (0.01140201, 0.596599). Assuming that there are 320 million people in the United States, the 3,648,643.  
